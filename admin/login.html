<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>System Access | Academia</title>
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700&family=Space+Grotesk:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Icons & Tools -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>

    <script>
        // Session Guard
        if (localStorage.getItem('adminToken')) {
            window.location.href = 'index.html';
        }

        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: { sans: ['Outfit', 'sans-serif'], display: ['Space Grotesk', 'sans-serif'] },
                    colors: {
                        glass: { border: 'rgba(255, 255, 255, 0.1)' },
                        neon: { red: '#EF4444', cyan: '#06B6D4', purple: '#A855F7' }
                    }
                }
            }
        }
    </script>

    <style>
        body { background: #0f172a; color: white; overflow: hidden; }
        .ambient-bg {
            position: fixed; inset: 0; z-index: -1;
            background: radial-gradient(circle at 50% 50%, rgba(239, 68, 68, 0.05), transparent 50%);
        }
        .glass-panel {
            background: rgba(255, 255, 255, 0.03);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 20px 50px rgba(0,0,0,0.5);
        }
        .glass-input {
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.1);
            color: white; text-align: center; letter-spacing: 0.2em;
        }
        .glass-input:focus { border-color: #EF4444; outline: none; box-shadow: 0 0 15px rgba(239, 68, 68, 0.3); }
        .scan-line {
            width: 100%; height: 2px;
            position: absolute; top: 0; left: 0;
            background: #EF4444;
            box-shadow: 0 0 10px #EF4444;
            animation: scan 3s linear infinite;
            opacity: 0.5;
        }
        @keyframes scan { 0% { top: 0; opacity: 0; } 50% { opacity: 1; } 100% { top: 100%; opacity: 0; } }
    </style>
</head>
<body class="h-screen flex items-center justify-center relative">

    <div class="ambient-bg"></div>
    
    <!-- Login Card -->
    <div class="glass-panel p-10 rounded-2xl w-full max-w-sm relative overflow-hidden opacity-0 translate-y-10" id="login-card">
        <div class="scan-line"></div>
        
        <div class="text-center mb-10">
            <div class="w-16 h-16 rounded-full bg-neon-red/10 flex items-center justify-center mx-auto mb-4 border border-neon-red/20 shadow-[0_0_20px_rgba(239,68,68,0.2)]">
                <i data-lucide="shield-alert" class="w-8 h-8 text-neon-red"></i>
            </div>
            <h1 class="font-display font-bold text-2xl text-white tracking-wide">RESTRICTED ACCESS</h1>
            <p class="text-xs text-gray-500 uppercase tracking-[0.2em] mt-2">Authorized Personnel Only</p>
        </div>

        <form id="loginForm" class="space-y-6">
            <div class="relative group">
                <div class="absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none text-gray-500 group-focus-within:text-neon-red transition-colors">
                    <i data-lucide="user" class="w-4 h-4"></i>
                </div>
                <input type="text" id="username" class="glass-input w-full rounded-lg py-3 pl-12 pr-4 transition-all uppercase tracking-widest text-sm" placeholder="USERNAME" required>
            </div>
            
            <div class="relative group">
                <div class="absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none text-gray-500 group-focus-within:text-neon-red transition-colors">
                    <i data-lucide="lock" class="w-4 h-4"></i>
                </div>
                <input type="password" id="password" class="glass-input w-full rounded-lg py-3 pl-12 pr-4 transition-all text-sm" placeholder="PASSWORD" required>
            </div>
            
            <button type="submit" class="w-full py-3 rounded-lg bg-neon-red hover:bg-red-600 text-black font-bold uppercase tracking-widest transition-all shadow-[0_0_20px_rgba(239,68,68,0.3)] hover:shadow-[0_0_30px_rgba(239,68,68,0.5)]">
                Authenticate
            </button>
        </form>
        
        <p id="error" class="text-red-500 text-xs text-center mt-6 h-4 opacity-0 transition-opacity">
            <i data-lucide="alert-circle" class="w-3 h-3 inline mr-1"></i> Invalid Security Key
        </p>

        <div class="mt-8 pt-6 border-t border-white/5 text-center">
             <a href="../index.html" class="text-xs text-gray-500 hover:text-white transition-colors">‚Üê Return to Public Terminal</a>
        </div>
    </div>

    <script src="../frontend/js/config.js"></script>
    <script>
        // already logged in check
        if (localStorage.getItem('studentToken')) {
            window.location.href = 'frontend/courses.html';
        }

        lucide.createIcons();

        // Animation
        gsap.to("#login-card", {
            opacity: 1,
            y: 0,
            duration: 1,
            ease: "power4.out",
            delay: 0.2
        });

        // Logic
        document.getElementById('loginForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            const btn = e.target.querySelector('button');
            const errorEl = document.getElementById('error');
            const originalText = btn.innerText;

            // Loading Effect
            btn.innerText = "VERIFYING...";
            btn.disabled = true;
            btn.classList.add('opacity-70', 'cursor-not-allowed');
            errorEl.style.opacity = '0';
            
            try {
                const res = await fetch(`${CONFIG.API_BASE_URL}/auth/login`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ username, password })
                });
                const data = await res.json();

                if (res.ok) {
                    localStorage.setItem('adminToken', data.token);
                    localStorage.setItem('adminName', data.user.name);
                    
                    // Success Anim
                    btn.classList.replace('bg-neon-red', 'bg-green-500');
                    btn.innerText = "ACCESS GRANTED";
                    
                    setTimeout(() => window.location.href = 'index.html', 800);
                } else {
                    errorEl.innerText = data.message || "Invalid Security Credentials";
                    errorEl.style.opacity = '1';
                    document.getElementById('password').value = '';
                    document.getElementById('password').focus();
                    
                    // Shake Effect
                    gsap.fromTo("#login-card", {x: -10}, {x: 10, duration: 0.1, repeat: 5, yoyo: true});
                    
                    btn.innerText = originalText;
                    btn.disabled = false;
                    btn.classList.remove('opacity-70', 'cursor-not-allowed');
                }
            } catch (err) {
                errorEl.innerText = "Quantum Link Failure (Check Connection)";
                errorEl.style.opacity = '1';
                btn.innerText = originalText;
                btn.disabled = false;
                btn.classList.remove('opacity-70', 'cursor-not-allowed');
            }
        });
    </script>
</body>
</html>
